<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <title>Wheel MoMA</title>
    <style>

        header {
            position: relative;
            padding: 2vw;
        }

        header a img {
            position: fixed;
            width: 15vw;
            top: 2vw;   
            left: 5vw;  
        }

        header h1 {
            position: fixed;
            top: 9vw; 
            left: 32vw;  
            font-size: 1.4vw; 
            color: black;   
            margin: 0;   
            font-family: Arial, Helvetica, sans-serif;
            font:bolder;
            text-decoration: underline;
        }

        .container {
            position: fixed;
            width: 30vw;
            margin-left: 23vw;
            margin-top: 18vw;
        }

        .tray {
            position: absolute; 
            top: 0;
            left: 10vw;
            width: 100%;
            height: auto;
            z-index: 1;
            transition: opacity 2s ease; 
            opacity: 1;
        }

        .tray.hidden {
            opacity: 0; 
            pointer-events: none; 
        }

        .tray img {
            width: 100%;
            height: auto;
            display: block;
            z-index: 1;
        }

        .wheel {
            position: absolute;
            bottom: 64%; 
            left: 37%; 
            transform: translateX(-20%) scale(0.75); 
            z-index: 2;
            transform-origin: center;
        }

        .spinning {
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            from {
                transform: translateX(-20%) scale(0.75) rotate(0deg);
            }
            to {
                transform: translateX(-20%) scale(0.75) rotate(360deg);
            }
        }

        .hand {
            position: absolute;
            bottom: 22%;
            right: -12%; 
            transform: scale(0.38); 
            z-index: 3;
        }

        .tray:nth-of-type(2) {
            z-index: 4; 
        }

        .rolling-box {
            position: fixed;
            top: 2vw;
            right: 5vw;
            width: 8vw;
            height: 3vw;
            background-color: rgb(0, 179, 255);
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgb(0, 0, 0);
            font-size: 1.5vw;
            font-weight: bolder;
            z-index: 5;
            cursor: pointer;
        }

        .rolling-box.active {
            background-color: rgb(174, 235, 255);
        }

        .wheel-text, .new-text {
            position: absolute;
            right: 5vw;
            font-size: 1vw;
            color: rgb(0, 0, 0);
            opacity: 0; 
            transition: opacity 2s ease; 
            z-index: 0;
        }

        .wheel-text {
            top: 50vw;
            font-size: 2vw;
            width: 30vw;
            height: 20vw;
            color: black;
            left: 4vw;
            font-weight: bold;
        }

        .wheel-text h {
            position:absolute;
            top:3vw;
            right:0vw;
            width:30vw;
            font-size: 1.5vw;
            font-weight:normal;
            font-style: italic;
        }

        .wheel-text p{
            position:absolute;
            top:4vw;
            left:0vw;
            width:40vw;
            font-size: 1.5vw;
            font-weight:normal;
            font-style: italic;
        }

        .new-text {
            top: 60vw;
            right: 5vw;
            font-size: 1.5vw;
            width: 60vw;
            height: 17vw;
            font-weight: lighter;
        }

        .visible {
            opacity: 1; 
        }

        #scroll-delay {
            position: fixed;
            top: 1.25vw;
            right: 17vw;
            color: rgb(0, 179, 255); 
            font-size: 3vw;
            z-index: 4;
            font-weight: bold;
        }

        footer {
            position: absolute;
            top: 85vw;
            left:0;
            background-color: #cfcfcf;
            color: black;
            width: 100%;
            height:15vw;
            z-index: -2;
        }

        footer img {
            position: absolute;
            left: 5vw;
            top: 9vw;
            width: 10vw;
            height: auto;
            z-index: 1;
        }

        footer p {
            position: absolute;
            top: 0vw;
            left: 5vw;
            font-size: 1.5vw;
            z-index: 1;
            font-weight: bolder;
        }

        .lazy {
            opacity: 0; /* 图片初始不可见 */
            transition: opacity 2s ease; /* 渐隐动画 */
        }

        .lazy.loaded {
            opacity: 1; /* 图片完全显示 */
        }

        #scroll-log {
            position: fixed;
            top: 7vw;
            left: 4.5vw;
            padding: 10px;
            max-width: 20vw;
            max-height: 15vw;
            font-family: Arial;
            z-index: 1000;
        }

        #scroll-log h3{
            font-size:1.4vw;

        }

        .log-container {
            max-height: 200px;
            overflow-y: auto;
            font-size: 12px;
            line-height: 1.5;
        }

        .log-item {
            padding: 5px;
            border-bottom: 1px solid #ddd;
            font-family: Arial;
        }

        .log-item.error {
            color: red;
        }

                /* 按钮样式 */
        #print-log-btn {
            position: fixed; /* 固定位置 */
            top: 8vw; /* 距离顶部 */
            left: 20vw; /* 与日志容器对齐 */
            background-color: #ffffff; /* 灰色背景 */
            color: #000000; /* 白色文字 */
            border: none; /* 去掉边框 */
            border-radius: 4px; /* 圆角 */
            padding: 15px 25px; /* 内边距 */
            font-size: 1.4vw; /* 字体大小 */
            cursor: pointer; /* 鼠标悬停效果 */
            z-index:1000;
            font-weight: bold;
        }

        #print-log-btn:hover {
            background-color:rgb(0, 179, 255); /* 鼠标悬停变暗 */
        }





    </style>
</head>
<body>
    <header>
        <a href="https://www.moma.org/collection/works/81631" target="_blank">
            <img src="moma.png" alt="moma">
        </a>

        <a href="DAPO.html" target="_blank">
            <h1>Art and artists</h1>
        </a>
    </header>

    <div class="container">
        <div class="tray">
            <img src="tray bike.png" alt="tray">
            <div class="wheel">
                <img src="wheel big.png" alt="wheel">
            </div>
            <div class="hand">
                <img src="tray bike hand.png" alt="hand">
            </div>
        </div>

        <div class="tray">
            <img src="tray bike2.png" alt="tray">
            <div class="wheel">
                <img src="wheel2.png" alt="wheel">
            </div>
            <div class="hand">
                <img src="bike hand2.png" alt="hand">
            </div>
        </div>
    </div>


    <div class="rolling-box" onclick="startRolling()">SCROLL</div>

    <div class="wheel-text">Marcel Duchamp
        <h>Bicycle Wheel</h>
        <p>New York, 1951 (third version, after lost original of 1913)</p>
    </div>

    <div class="new-text">
        A readymade by Marcel Duchamp, consisting of a bicycle fork and front wheel, mounted upside down on a wooden stool. In 1913, Duchamp mounted the bicycle wheel upside down on a stool in his Paris studio, occasionally rotating it just to look at it. He later denied that he had done the work intentionally, although it has since been called his first readymade. Both the original 1913 version and a second version from 1916-17 are lost. Duchamp recreated another version of the sculpture in 1951. Bicycle Wheel is said to be the first kinetic sculpture.
    </div>


    <div id="scroll-delay">Delay <span id="delay-value">0</span>ms</div>

    <footer>
        <a href="https://www.tate.org.uk/art/artworks/duchamp-fountain-t07573">
            <img src="moma.png" alt="Tate logo">
        </a>
        <p>About us</p>
    </footer>

    <div id="scroll-log">
        <h3>Scroll Delay Logs</h3>
        <div id="log-container" class="log-container"></div>
    </div>

    <button id="print-log-btn">Print Log</button>
    

    <script>
        let clickCount = 0;
        let lastScrollTime = performance.now();

        document.querySelectorAll('.wheel').forEach(wheel => {
            wheel.classList.add('spinning');
        });

        function startRolling() {
            clickCount++;
            const progressBar = document.getElementById("progressBar");

            if (clickCount === 1) {
                const rollingBox = document.querySelector('.rolling-box');
                rollingBox.classList.add('active');

                const wheelText = document.querySelector('.wheel-text');
                wheelText.classList.add('visible');

                progressBar.style.width = "50%";
            } else if (clickCount === 2) {
                const secondTray = document.querySelectorAll('.tray')[1];
                secondTray.classList.add('hidden');

                const newText = document.querySelector('.new-text');
                newText.classList.add('visible');

                progressBar.style.width = "100%";
            } else if (clickCount === 3) {
                resetPage();
            }
        }

        function resetPage() {
            const rollingBox = document.querySelector('.rolling-box');
            rollingBox.classList.remove('active');

            const wheelText = document.querySelector('.wheel-text');
            wheelText.classList.remove('visible');

            const newText = document.querySelector('.new-text');
            newText.classList.remove('visible');

            const secondTray = document.querySelectorAll('.tray')[1];
            secondTray.classList.remove('hidden');

            document.getElementById("progressBar").style.width = "0";
            clickCount = 0;
        }

        // 监控滚动操作并记录延迟信息
        function logMessage(message) {
            const logContainer = document.getElementById('log-container');
            const logItem = document.createElement('div');
            logItem.className = 'log-item';
            logItem.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.appendChild(logItem);

            // 自动滚动到最新日志
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function updateDelayValue(delay) {
            const delayElement = document.getElementById('delay-value');
            delayElement.textContent = delay + " ";
        }

        window.addEventListener('scroll', () => {
            const currentTime = performance.now();
            const delay = Math.round(currentTime - lastScrollTime);

            // 使用 logMessage 方法记录滚动延迟信息
            logMessage(`Scroll Delay: ${delay} ms`);

            // 更新延迟值到界面上的 delay-value 元素中
            updateDelayValue(delay);

            lastScrollTime = currentTime;

            const baseDelay = 8;
            const baseDuration = 2;

            const newDuration = baseDuration - (delay / baseDelay);

            // 更新动画持续时间并同步到界面
            document.querySelectorAll('.spinning').forEach(wheel => {
                wheel.style.animationDuration = `${Math.max(newDuration, 0.5)}s`;
            });
        });

                // 添加打印日志功能
                document.getElementById('print-log-btn').addEventListener('click', () => {
            // 获取日志容器内容
            const logContainer = document.getElementById('scroll-log');
            const logs = logContainer.innerText; // 获取文本内容

            // 创建 PDF
            const { jsPDF } = window.jspdf; // 确保引入了 jsPDF 库
            const pdf = new jsPDF();

            // 设置标题
            pdf.setFontSize(16);
            pdf.text('Log Records', 10, 10); // 标题

            // 插入日志内容
            pdf.setFontSize(12);
            const lineHeight = 10; // 行高
            const lines = logs.split('\n'); // 按行分割
            let y = 20; // 初始位置

            lines.forEach((line) => {
                pdf.text(line, 10, y); // 添加每行文本
                y += lineHeight; // 行高递增
            });

            // 下载 PDF
            pdf.save('log-records.pdf');
        });


    </script>

</body>
</html>
